## fullatom protein c-terminus patch to allow connection to C-term of protein

NAME CtermConnect
TYPES CTERM_CONNECT UPPER_TERMINUS_VARIANT BRANCH_LOWER_TERMINUS_VARIANT

## general requirements for this patch

BEGIN_SELECTOR
PROPERTY POLYMER
NOT PROPERTY CARBOHYDRATE
NOT PROPERTY RNA
NOT PROPERTY DNA
NOT PROPERTY PHOSPHONATE
NOT PROPERTY TERMINUS
NOT VARIANT_TYPE UPPER_TERMINUS_VARIANT
NOT NAME3 XXX
END_SELECTOR

## now we search for a case that matches the residue, take the first one
## so put generic case last

BEGIN_CASE ### THE GENERAL CASE ##########################################

## delete the polymer connection
SET_POLYMER_CONNECT UPPER NONE

## here we add the new connection point, the icoor values are bogus
##
ADD_CONNECT C ICOOR 180.0 60.0 1.2 C CA N

SET_ICOOR O 180.0 60 1.2 C CA CONN%NCONN

ADD_PROPERTY UPPER_TERMINUS ## implies terminus
ADD_PROPERTY BRANCH_LOWER_TERMINUS

END_CASE
