# icoor are imperfect but generally reading in from PDB will fix everything.
NAME 3Prime2PrimeCyclicPhos
TYPES  THREE_PRIME_TWO_PRIME_CYCLIC_PHOSPHATE

BEGIN_SELECTOR
PROPERTY RNA
NOT VARIANT_TYPE UPPER_TERMINUS_VARIANT
NOT VARIANT_TYPE THREE_PRIME_END_OH
NOT VARIANT_TYPE FIVE_PRIME_END_OH
NOT VARIANT_TYPE BULGE
NOT VARIANT_TYPE VIRTUAL_RNA_RESIDUE_EXCLUDE_PHOSPHATE
NOT VARIANT_TYPE VIRTUAL_RNA_RESIDUE
#NOT VARIANT_TYPE VIRTUAL_RIBOSE, should ideally have this constraint on, but otherwise removing/adding variants is a pain.
NOT VARIANT_TYPE VIRTUAL_BASE_HEAVY_ATOM
NOT VARIANT_TYPE VIRTUAL_BACKBONE_EXCEPT_C1PRIME
NOT VARIANT_TYPE CUTPOINT_LOWER
NOT VARIANT_TYPE FIVEPRIME_CAP
NOT VARIANT_TYPE THREE_PRIME_TWO_PRIME_CYCLIC_PHOSPHATE  
END_SELECTOR

# Special case for RCY to rename to CCC
BEGIN_CASE
BEGIN_SELECTOR
AA RCY
END_SELECTOR

ADD_PROPERTY UPPER_TERMINUS

SET_IO_STRING CCC c

ADD_ATOM YP   Phos H   1.5
ADD_ATOM YOP2 OOC  H   -0.78
ADD_ATOM YOP1 OOC  H   -0.78
SET_ATOM_TYPE HO2' VIRT

ADD_BOND YP    O3'
ADD_BOND YP   YOP2
ADD_BOND YP   YOP1
ADD_BOND YP    O2'

SET_ICOOR   YP     91.157639   76.647797    1.630816   O3'   C3'   C4'
SET_ICOOR   YOP2  125.473076   71.003654    1.480124  YP     O3'   C3'
SET_ICOOR   YOP1  118.670937   70.832054    1.480124  YP     O3'  YOP2

END_CASE

BEGIN_CASE ### general ###

ADD_PROPERTY UPPER_TERMINUS

ADD_ATOM YP   Phos H   1.5
ADD_ATOM YOP2 OOC  H   -0.78
ADD_ATOM YOP1 OOC  H   -0.78
SET_ATOM_TYPE HO2' VIRT

ADD_BOND YP    O3'
ADD_BOND YP   YOP2
ADD_BOND YP   YOP1
ADD_BOND YP    O2'

SET_ICOOR   YP     91.157639   76.647797    1.630816   O3'   C3'   C4'
SET_ICOOR   YOP2  125.473076   71.003654    1.480124  YP     O3'   C3'
SET_ICOOR   YOP1  118.670937   70.832054    1.480124  YP     O3'  YOP2

END_CASE
