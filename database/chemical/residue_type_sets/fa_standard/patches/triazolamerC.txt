NAME triazolamerC
TYPES TRIAZOLAMERC

## general requirements for this patch

BEGIN_SELECTOR
NOT PROPERTY DNA
NOT PROPERTY RNA
NOT PROPERTY CARBOHYDRATE
NOT PROPERTY METAL
PROPERTY PROTEIN TERMINUS
NOT VARIANT_TYPE A3B_HBS_PRE
NOT VARIANT_TYPE A3B_HBS_POST
NOT VARIANT_TYPE HBS_POST
NOT VARIANT_TYPE HBS_PRE
NOT VARIANT_TYPE OOP_PRE
NOT VARIANT_TYPE OOP_POST
NOT PROPERTY PHOSPHONATE
NOT VARIANT_TYPE CUTPOINT_UPPER
NOT VARIANT_TYPE CUTPOINT_LOWER
# not impossible but future work
NOT VARIANT_TYPE N_ACETYLATION 
NOT VARIANT_TYPE METHYLATED_NTERM_VARIANT 
NOT VARIANT_TYPE ACETYLATED_NTERMINUS_VARIANT
NOT VARIANT_TYPE UPPER_TERMINUS_VARIANT
NOT VARIANT_TYPE METHYLATED_CTERMINUS_VARIANT
NOT PROPERTY PHOSPHONATE
NOT NAME3 YPN

# Exclude secondary amines
NOT VARIANT_TYPE HYDROXYLATION1 # PRO variants that resist selection by NAME3
NOT VARIANT_TYPE HYDROXYLATION2 # PRO variants that resist selection by NAME3
NOT AA PRO
NOT AA DPR
NOT NAME3 DPR
NOT NAME3 HPR
NOT NAME3 0AZ
NOT NAME3 HYP
NOT NAME3 B3P
NOT NAME3 B19
NOT NAME3 C89
NOT NAME3 B59
NOT NAME3 HYP
NOT NAME3 0AZ

# Too many atoms! Has a CT1 and stuff.
NOT NAME3 TES
NOT NAME3 S56
NOT NAME3 BCS
NOT NAME3 A31
NOT NAME3 C80
NOT NAME3 C81
NOT NAME3 C87
NOT NAME3 C88
NOT NAME3 B35
NOT NAME3 B36
NOT NAME3 B38
NOT NAME3 B44
NOT NAME3 B74
END_SELECTOR

## now we search for a case that matches the residue, take the first one
## so put generic case last

# For ACE
BEGIN_CASE

BEGIN_SELECTOR
#NAME3 ACE
PROPERTY TERMINUS
END_SELECTOR

ADD_ATOM VNT3 VIRT VIRT  0.00
ADD_ATOM  CT1 aroC CPH1 -0.03
ADD_ATOM  CT2 aroC CPH1 -0.03
ADD_ATOM  HT2 Haro HA    0.09
ADD_BOND CH3 CT1
ADD_BOND CT1 CT2
ADD_BOND CT2 HT2
ADD_BOND CT1 VNT3

# To be totally general, we want to replace our mainchain atom by name not number
# (because for some relevant residue types, maybe e.g. C is mainchain atom number 17)
REPLACE_MAINCHAIN_ATOM	C	CT1
#SET_POLYMER_CONNECT UPPER CT1

ADD_CONNECT CT1 ICOOR	153.400000	57.400000	1.347000	CT1	CH3  1HH3

SET_ATOM_TYPE     C VIRT
SET_MM_ATOM_TYPE  C VIRT
SET_ATOMIC_CHARGE C 0.00

SET_ATOM_TYPE     O VIRT
SET_MM_ATOM_TYPE  O VIRT
SET_ATOMIC_CHARGE O 0.00

# Fix these based on where the C and N would still be!!
SET_ICOOR CT1     0.000000	69.900000	1.459211	 CH3	1HH3	 C
SET_ICOOR CT2    29.400000	50.200000	1.347000	 CT1	 CH3	1HH3
SET_ICOOR HT2    -2.100000	47.400000	1.100000	 CT2	 CT1	 CH3
SET_ICOOR UPPER	177.700000	55.900000	1.347000	 CT2	 CT1	 CH3
SET_ICOOR VNT3  153.400000	57.400000	1.347000	 CT1	 CH3	1HH3
# Needed to be able to rebuild virts
SET_ICOOR O       0.000000	50.200000	1.347000     CT1	CH3	CT2 #NT1

# Will cause
# ERROR: Residue::conect_atom: I'm not bonded to that other residue!!
# ERROR:: Exit from: src/core/conformation/Residue.cc line: 1116
# due to branch_connection_torsion_angle_atoms
#ADD_PROPERTY BRANCH_LOWER_TERMINUS

END_CASE


BEGIN_CASE

BEGIN_SELECTOR
PROPERTY PROTEIN
END_SELECTOR

ADD_ATOM VNT3 VIRT VIRT  0.00
ADD_ATOM  CT1 aroC CPH1 -0.03
ADD_ATOM  CT2 aroC CPH1 -0.03
ADD_ATOM  HT2 Haro HA    0.09
ADD_BOND CA CT1
ADD_BOND CT1 CT2
ADD_BOND CT2 HT2
ADD_BOND CT1 VNT3

# To be totally general, we want to replace our mainchain atom by name not number
# (because for some relevant residue types, maybe e.g. C is mainchain atom number 17)
REPLACE_MAINCHAIN_ATOM	C	CT1
#SET_POLYMER_CONNECT UPPER CT1

ADD_CONNECT CT1 ICOOR	153.400000	57.400000	1.347000	CT1	CA  N

SET_ATOM_TYPE     C VIRT
SET_MM_ATOM_TYPE  C VIRT
SET_ATOMIC_CHARGE C 0.00

SET_ATOM_TYPE     O VIRT
SET_MM_ATOM_TYPE  O VIRT
SET_ATOMIC_CHARGE O 0.00

# Fix these based on where the C and N would still be!!
#SET_ICOOR CT1   -97.400000	69.900000	1.459211  CA	NT1	NT2
SET_ICOOR CT1     0.000000	69.900000	1.459211  CA	N   C #NT1	NT2
SET_ICOOR CT2    29.400000	50.200000	1.347000  CT1	CA	N #NT1
SET_ICOOR HT2    -2.100000	47.400000	1.100000  CT2	CT1	CA
SET_ICOOR UPPER	177.700000	55.900000	1.347000  CT2	CT1	CA
#SET_ICOOR UPPER	153.400000	57.400000	1.347000	CT1	CA  N #NT1
SET_ICOOR VNT3 153.400000	57.400000	1.347000	CT1	CA  N
# Needed to be able to rebuild virts
SET_ICOOR O       0.000000	50.200000	1.347000  CT1	CA	CT2 #NT1

# Will cause
# ERROR: Residue::conect_atom: I'm not bonded to that other residue!!
# ERROR:: Exit from: src/core/conformation/Residue.cc line: 1116
# due to branch_connection_torsion_angle_atoms
#ADD_PROPERTY BRANCH_LOWER_TERMINUS

END_CASE
